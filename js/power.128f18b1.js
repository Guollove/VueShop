"use strict";(self["webpackChunkvue_shop"]=self["webpackChunkvue_shop"]||[]).push([[832],{179:function(e,t,s){s.d(t,{Z:function(){return d}});var r=function(){var e=this,t=e._self._c;return t("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[t("el-breadcrumb-item",{attrs:{to:{path:"/home"}}},[e._v("首页")]),e._l(e.bread,(function(s,r){return t("el-breadcrumb-item",{key:r},[e._v(e._s(s))])}))],2)},i=[],a={props:["bread"]},l=a,o=s(1),n=(0,o.Z)(l,r,i,!1,null,null,null),d=n.exports},490:function(e,t,s){s.r(t),s.d(t,{default:function(){return c}});var r=function(){var e=this,t=e._self._c;return t("div",[t("Breadcrumb",{attrs:{bread:e.rightsBread}}),t("el-card",[t("el-table",{attrs:{data:e.rightsList,border:"",stripe:""}},[t("el-table-column",{attrs:{align:"center",label:"序",type:"index"}}),t("el-table-column",{attrs:{align:"center",label:"权限名称",prop:"authName"}}),t("el-table-column",{attrs:{align:"center",label:"路径",prop:"path"}}),t("el-table-column",{attrs:{align:"center",label:"权限等级",prop:"level"},scopedSlots:e._u([{key:"default",fn:function(s){return["0"===s.row.level?t("el-tag",[e._v("一级")]):"1"===s.row.level?t("el-tag",{attrs:{type:"success"}},[e._v("二级")]):t("el-tag",{attrs:{type:"warning"}},[e._v("三级")])]}}])})],1)],1)],1)},i=[],a=s(179),l={components:{Breadcrumb:a.Z},data(){return{rightsBread:["权限管理","权限列表"],rightsList:[]}},created(){this.getRightsList()},methods:{async getRightsList(){const{data:e}=await this.$http.get("rights/list");if(200!==e.meta.status)return this.$message.error("获取权限列表失败！");this.rightsList=e.data}}},o=l,n=s(1),d=(0,n.Z)(o,r,i,!1,null,"2a9fbae6",null),c=d.exports},132:function(e,t,s){s.r(t),s.d(t,{default:function(){return c}});var r=function(){var e=this,t=e._self._c;return t("div",[t("Breadcrumb",{attrs:{bread:e.rolesBread}}),t("el-card",[t("el-row",[t("el-col",[t("el-button",{attrs:{type:"primary"},on:{click:function(t){e.addDialogRoles=!0}}},[e._v("添加角色")])],1)],1),t("el-table",{attrs:{data:e.rolelist,border:"",stripe:""}},[t("el-table-column",{attrs:{align:"center",label:"√",type:"expand"},scopedSlots:e._u([{key:"default",fn:function(s){return e._l(s.row.children,(function(r,i){return t("el-row",{key:r.id,class:["bdbottom",0===i?"bdtop":"","vcenter"]},[t("el-col",{attrs:{span:5}},[t("el-tag",{attrs:{closable:""},on:{close:function(t){return e.removeRightById(s.row,r.id)}}},[e._v(e._s(r.authName))]),t("i",{staticClass:"el-icon-caret-right"})],1),t("el-col",{attrs:{span:19}},e._l(r.children,(function(r,i){return t("el-row",{key:r.id,class:[0===i?"":"bdtop","vcenter"]},[t("el-col",{attrs:{span:6}},[t("el-tag",{attrs:{type:"success",closable:""},on:{close:function(t){return e.removeRightById(s.row,r.id)}}},[e._v(e._s(r.authName))]),t("i",{staticClass:"el-icon-caret-right"})],1),t("el-col",{attrs:{span:18}},e._l(r.children,(function(r){return t("el-tag",{key:r.id,attrs:{type:"warning",closable:""},on:{close:function(t){return e.removeRightById(s.row,r.id)}}},[e._v(e._s(r.authName))])})),1)],1)})),1)],1)}))}}])}),t("el-table-column",{attrs:{align:"center",label:"#",type:"index"}}),t("el-table-column",{attrs:{align:"center",label:"角色名称",prop:"roleName"}}),t("el-table-column",{attrs:{align:"center",label:"角色描述",prop:"roleDesc"}}),t("el-table-column",{attrs:{align:"center",label:"操作",width:"300px"},scopedSlots:e._u([{key:"default",fn:function(s){return[t("el-button",{attrs:{size:"mini",type:"primary",icon:"el-icon-edit"},on:{click:function(t){return e.showEditdialog(s.row.id)}}},[e._v("编辑")]),t("el-button",{attrs:{size:"mini",type:"danger",icon:"el-icon-delete"},on:{click:function(t){return e.removeRolesById(s.row.id)}}},[e._v("删除")]),t("el-button",{attrs:{size:"mini",type:"warning",icon:"el-icon-setting"},on:{click:function(t){return e.showSetRightDialog(s.row)}}},[e._v("分配权限")])]}}])})],1),t("el-dialog",{attrs:{title:"添加角色",visible:e.addDialogRoles,width:"50%"},on:{"update:visible":function(t){e.addDialogRoles=t},close:e.addDialogClosedR}},[t("el-form",{ref:"addFormRolesRef",attrs:{model:e.addForm,rules:e.addFormRulesRoles,"label-width":"90px"}},[t("el-form-item",{attrs:{label:"角色名称",prop:"roleName"}},[t("el-input",{model:{value:e.addForm.roleName,callback:function(t){e.$set(e.addForm,"roleName",t)},expression:"addForm.roleName"}})],1),t("el-form-item",{attrs:{label:"角色描述",prop:"roleDesc"}},[t("el-input",{model:{value:e.addForm.roleDesc,callback:function(t){e.$set(e.addForm,"roleDesc",t)},expression:"addForm.roleDesc"}})],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.addDialogRoles=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.addRoles}},[e._v("确 定")])],1)],1)],1),t("el-dialog",{attrs:{title:"修改用户",visible:e.editDialogVisible,width:"50%"},on:{"update:visible":function(t){e.editDialogVisible=t},close:e.editDialogClosed}},[t("el-form",{ref:"editFormRolesRef",attrs:{model:e.editForm,rules:e.editFormRules,"label-width":"90px"}},[t("el-form-item",{attrs:{label:"角色名称",prop:"roleName"}},[t("el-input",{model:{value:e.editForm.roleName,callback:function(t){e.$set(e.editForm,"roleName",t)},expression:"editForm.roleName"}})],1),t("el-form-item",{attrs:{label:"角色描述",prop:"roleDesc"}},[t("el-input",{model:{value:e.editForm.roleDesc,callback:function(t){e.$set(e.editForm,"roleDesc",t)},expression:"editForm.roleDesc"}})],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.editDialogVisible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.editRolesInfo}},[e._v("确 定")])],1)],1),t("el-dialog",{attrs:{title:"分配权限",visible:e.setRightDialogVisible,width:"50%"},on:{"update:visible":function(t){e.setRightDialogVisible=t},close:e.setRightDialogClosed}},[t("el-tree",{ref:"treeRef",attrs:{data:e.rightslist,props:e.treeProps,"show-checkbox":"","node-key":"id","default-expand-all":"","default-checked-keys":e.defKeys}}),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.setRightDialogVisible=!1}}},[e._v("取消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.allotRights}},[e._v("确认")])],1)],1)],1)},i=[],a=s(179),l={components:{Breadcrumb:a.Z},data(){return{rolesBread:["权限管理","角色管理"],rolelist:[],addDialogRoles:!1,addForm:{roleName:"",roleDesc:""},addFormRulesRoles:{roleName:[{required:!0,message:"请输入角色名称",trigger:"blur"},{min:2,max:20,message:"角色名称的长度在2～20个字符之间",trigger:"blur"}],roleDesc:[{required:!0,message:"请输入角色描述",trigger:"blur"},{min:2,max:20,message:"角色描述的长度在2～20个字符之间",trigger:"blur"}]},editDialogVisible:!1,editForm:{},editFormRules:{roleName:[{required:!0,message:"请输入角色名称",trigger:"blur"},{min:2,max:20,message:"角色名称的长度在2～20个字符之间",trigger:"blur"}],roleDesc:[{required:!0,message:"请输入角色描述",trigger:"blur"},{min:2,max:20,message:"角色描述的长度在2～20个字符之间",trigger:"blur"}]},setRightDialogVisible:!1,rightslist:[],treeProps:{label:"authName",children:"children"},defKeys:[],roleId:""}},created(){this.getRolesList()},methods:{async getRolesList(){const{data:e}=await this.$http.get("roles");if(200!==e.meta.status)return this.$message.error("获取角色列表失败！");this.rolelist=e.data},addDialogClosedR(){this.$refs.addFormRolesRef.resetFields()},addRoles(){this.$refs.addFormRolesRef.validate((async e=>{if(!e)return;const{data:t}=await this.$http.post("roles",this.addForm);201!==t.meta.status&&this.$message.error("添加用户失败"),this.$message.success("添加用户成功"),this.addDialogRoles=!1,this.getRolesList()}))},async removeRolesById(e){const t=await this.$confirm("此操作将永久删除该用户，是否继续","提示",{confirmButtonText:"确定",cancelIdleCallback:"取消",type:"warning"}).catch((e=>e));if("confirm"!==t)return this.$message.info("已取消删除");const{data:s}=await this.$http.delete("roles/"+e);if(200!==s.meta.status)return this.$message.error("删除用户失败！");this.$message.success(s.meta.msg),this.getRolesList()},async showEditdialog(e){const{data:t}=await this.$http.get("roles/"+e);if(200!==t.meta.status)return this.$message.error("查询用户信息失败");this.editForm=t.data,this.editDialogVisible=!0},editDialogClosed(){this.$refs.editFormRolesRef.resetFields()},editRolesInfo(){this.$refs.editFormRolesRef.validate((async e=>{if(!e)return;const{data:t}=await this.$http.put("roles/"+this.editForm.roleId,{roleName:this.editForm.roleName,roleDesc:this.editForm.roleDesc});if(200!==t.meta.status)return this.$message.error("更新用户信息失败！");this.editDialogVisible=!1,this.getRolesList(),this.$message.success(t.meta.msg)}))},async removeRightById(e,t){const s=await this.$confirm("此操作将永久删除该文件，是否继续？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).catch((e=>e));if("confirm"!==s)return this.$message.info("取消了删除！");const{data:r}=await this.$http.delete(`roles/${e.id}/rights/${t}`);if(200!==r.meta.status)return this.$message.error("删除权限失败！");this.$message.success("删除成功"),e.children=r.data},async showSetRightDialog(e){this.roleId=e.id;const{data:t}=await this.$http.get("rights/tree");if(200!==t.meta.status)return this.$message.error("获取权限数据失败！");this.rightslist=t.data,this.getLeaKeys(e,this.defKeys),this.setRightDialogVisible=!0},getLeaKeys(e,t){if(!e.children)return t.push(e.id);e.children.forEach((e=>this.getLeaKeys(e,t)))},setRightDialogClosed(){this.defKeys=[]},async allotRights(){const e=[...this.$refs.treeRef.getCheckedKeys(),...this.$refs.treeRef.getHalfCheckedKeys()],t=e.join(","),{data:s}=await this.$http.post(`roles/${this.roleId}/rights`,{rids:t});if(200!==s.meta.status)return this.$message.error("分配权限失败！");this.$message.success("分配权限成功！"),this.getRolesList(),this.setRightDialogVisible=!1}}},o=l,n=s(1),d=(0,n.Z)(o,r,i,!1,null,"173e38ae",null),c=d.exports}}]);
//# sourceMappingURL=power.128f18b1.js.map